# 橘橙影志 - 影视论坛系统后端接口设计文档

## 1. 项目概述

### 1.1 项目名称
橘橙影志 - 影视论坛系统

### 1.2 项目背景
构建一个专业的影视讨论平台，支持电影、电视剧、综艺等多种影视内容的分类管理和讨论。

### 1.3 技术栈
- **后端框架**: Spring Boot 3.x
- **数据库**: MySQL 8.x
- **ORM框架**: MyBatis
- **安全框架**: Spring Security + JWT
- **构建工具**: Maven

## 2. 数据库设计

### 2.1 核心表结构

#### 用户表 (users)
```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    nickname VARCHAR(50),
    avatar VARCHAR(255),
    level INT DEFAULT 1,
    join_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    posts_count INT DEFAULT 0,
    followers_count INT DEFAULT 0,
    following_count INT DEFAULT 0,
    status TINYINT DEFAULT 1 COMMENT '1:正常 0:禁用',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 电影表 (movies)
```sql
CREATE TABLE movies (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(200) NOT NULL,
    original_title VARCHAR(200),
    year INT,
    genre JSON,
    director VARCHAR(100),
    actors JSON,
    rating DECIMAL(3,1),
    poster VARCHAR(255),
    summary TEXT,
    awards JSON,
    duration INT COMMENT '时长(分钟)',
    country VARCHAR(50),
    language VARCHAR(50),
    trailer VARCHAR(255),
    photos JSON,
    views INT DEFAULT 0,
    likes INT DEFAULT 0,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 电视剧表 (tv_shows)
```sql
CREATE TABLE tv_shows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(200) NOT NULL,
    original_title VARCHAR(200),
    year INT,
    genre JSON,
    director VARCHAR(100),
    actors JSON,
    rating DECIMAL(3,1),
    poster VARCHAR(255),
    summary TEXT,
    awards JSON,
    seasons INT,
    episodes INT,
    country VARCHAR(50),
    language VARCHAR(50),
    trailer VARCHAR(255),
    photos JSON,
    views INT DEFAULT 0,
    likes INT DEFAULT 0,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 综艺表 (variety_shows)
```sql
CREATE TABLE variety_shows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(200) NOT NULL,
    original_title VARCHAR(200),
    year INT,
    genre JSON,
    host VARCHAR(100),
    guests JSON,
    rating DECIMAL(3,1),
    poster VARCHAR(255),
    summary TEXT,
    awards JSON,
    episodes INT,
    country VARCHAR(50),
    language VARCHAR(50),
    trailer VARCHAR(255),
    photos JSON,
    views INT DEFAULT 0,
    likes INT DEFAULT 0,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 演员表 (actors)
```sql
CREATE TABLE actors (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    avatar VARCHAR(255),
    birth_date DATE,
    nationality VARCHAR(50),
    gender ENUM('男', '女', '其他'),
    biography TEXT,
    movies_count INT DEFAULT 0,
    tv_shows_count INT DEFAULT 0,
    awards JSON,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 奖项表 (awards)
```sql
CREATE TABLE awards (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    category VARCHAR(100),
    year INT,
    description TEXT,
    winner_id BIGINT,
    winner_type ENUM('movie', 'tv_show', 'actor'),
    nominees JSON,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 分类表 (categories)
```sql
CREATE TABLE categories (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    type ENUM('content', 'genre', 'award'),
    parent_id BIGINT,
    description TEXT,
    count INT DEFAULT 0,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 帖子表 (posts)
```sql
CREATE TABLE posts (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    author_id BIGINT NOT NULL,
    category_id BIGINT,
    content_type ENUM('movie', 'tv_show', 'variety_show', 'general'),
    content_id BIGINT,
    views INT DEFAULT 0,
    likes INT DEFAULT 0,
    comments_count INT DEFAULT 0,
    status TINYINT DEFAULT 1 COMMENT '1:发布 0:草稿',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (author_id) REFERENCES users(id),
    FOREIGN KEY (category_id) REFERENCES categories(id)
);
```

#### 评论表 (comments)
```sql
CREATE TABLE comments (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    content TEXT NOT NULL,
    author_id BIGINT NOT NULL,
    post_id BIGINT NOT NULL,
    parent_id BIGINT,
    likes INT DEFAULT 0,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (author_id) REFERENCES users(id),
    FOREIGN KEY (post_id) REFERENCES posts(id),
    FOREIGN KEY (parent_id) REFERENCES comments(id)
);
```

#### 关注表 (follows)
```sql
CREATE TABLE follows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    follower_id BIGINT NOT NULL,
    following_id BIGINT NOT NULL,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (follower_id) REFERENCES users(id),
    FOREIGN KEY (following_id) REFERENCES users(id),
    UNIQUE KEY unique_follow (follower_id, following_id)
);
```

#### 通知表 (notifications)
```sql
CREATE TABLE notifications (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    type ENUM('like', 'comment', 'follow', 'system'),
    title VARCHAR(200),
    content TEXT,
    is_read TINYINT DEFAULT 0,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

## 3. 接口设计

### 3.1 用户认证模块

#### 3.1.1 用户注册
```
POST /api/auth/register
Content-Type: application/json

请求参数:
{
    "username": "string",
    "password": "string",
    "email": "string",
    "nickname": "string"
}

响应:
{
    "code": 200,
    "message": "注册成功",
    "data": {
        "token": "jwt_token",
        "user": {
            "id": 1,
            "username": "user123",
            "nickname": "用户昵称",
            "avatar": "avatar_url",
            "level": 1
        }
    }
}
```

#### 3.1.2 用户登录
```
POST /api/auth/login
Content-Type: application/json

请求参数:
{
    "username": "string",
    "password": "string"
}

响应:
{
    "code": 200,
    "message": "登录成功",
    "data": {
        "token": "jwt_token",
        "user": {
            "id": 1,
            "username": "user123",
            "nickname": "用户昵称",
            "avatar": "avatar_url",
            "level": 1
        }
    }
}
```

#### 3.1.3 用户登出
```
POST /api/auth/logout
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "登出成功"
}
```

#### 3.1.4 获取当前用户信息
```
GET /api/auth/me
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "username": "user123",
        "nickname": "用户昵称",
        "avatar": "avatar_url",
        "level": 1,
        "postsCount": 10,
        "followersCount": 50,
        "followingCount": 30
    }
}
```

### 3.2 用户管理模块

#### 3.2.1 获取用户信息
```
GET /api/users/{id}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "username": "user123",
        "nickname": "用户昵称",
        "avatar": "avatar_url",
        "level": 1,
        "joinDate": "2024-01-01T00:00:00",
        "postsCount": 10,
        "followersCount": 50,
        "followingCount": 30,
        "isFollowing": false
    }
}
```

#### 3.2.2 更新用户信息
```
PUT /api/users/{id}
Authorization: Bearer {token}
Content-Type: application/json

请求参数:
{
    "nickname": "string",
    "email": "string",
    "avatar": "string"
}

响应:
{
    "code": 200,
    "message": "更新成功",
    "data": {
        "id": 1,
        "nickname": "新昵称",
        "email": "new@email.com",
        "avatar": "new_avatar_url"
    }
}
```

#### 3.2.3 关注用户
```
POST /api/users/{id}/follow
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "关注成功"
}
```

#### 3.2.4 取消关注用户
```
DELETE /api/users/{id}/follow
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "取消关注成功"
}
```

#### 3.2.5 获取用户帖子
```
GET /api/users/{id}/posts?page=1&size=10

响应:
{
    "code": 200,
    "data": {
        "posts": [
            {
                "id": 1,
                "title": "帖子标题",
                "content": "帖子内容",
                "createTime": "2024-01-01T10:00:00",
                "views": 100,
                "likes": 20,
                "commentsCount": 5
            }
        ],
        "total": 10,
        "page": 1,
        "size": 10
    }
}
```

### 3.3 电影管理模块

#### 3.3.1 获取电影列表
```
GET /api/movies?page=1&size=10&genre=动作&year=2024&rating=8.0&actor=演员名&award=奥斯卡

响应:
{
    "code": 200,
    "data": {
        "movies": [
            {
                "id": 1,
                "title": "电影标题",
                "originalTitle": "Original Title",
                "year": 2024,
                "genre": ["动作", "科幻"],
                "director": "导演姓名",
                "actors": ["演员1", "演员2"],
                "rating": 8.5,
                "poster": "海报URL",
                "summary": "电影简介",
                "awards": ["奥斯卡最佳影片"],
                "duration": 120,
                "country": "美国",
                "language": "英语"
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

#### 3.3.2 获取电影详情
```
GET /api/movies/{id}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "title": "电影标题",
        "originalTitle": "Original Title",
        "year": 2024,
        "genre": ["动作", "科幻"],
        "director": "导演姓名",
        "actors": ["演员1", "演员2"],
        "rating": 8.5,
        "poster": "海报URL",
        "summary": "电影简介",
        "awards": ["奥斯卡最佳影片"],
        "duration": 120,
        "country": "美国",
        "language": "英语",
        "trailer": "预告片URL",
        "photos": ["剧照1", "剧照2"],
        "reviews": [
            {
                "id": 1,
                "content": "影评内容",
                "rating": 8.5,
                "author": {
                    "id": 1,
                    "username": "reviewer1",
                    "nickname": "影评人1",
                    "avatar": "avatar_url"
                },
                "createTime": "2024-01-01T10:00:00"
            }
        ]
    }
}
```

#### 3.3.3 搜索电影
```
GET /api/movies/search?keyword=关键词&genre=动作&year=2024&actor=演员名&award=奥斯卡&page=1&size=10

响应:
{
    "code": 200,
    "data": {
        "movies": [
            {
                "id": 1,
                "title": "搜索结果标题",
                "year": 2024,
                "genre": ["动作", "科幻"],
                "rating": 8.5,
                "poster": "海报URL"
            }
        ],
        "total": 50,
        "page": 1,
        "size": 10
    }
}
```

### 3.4 电视剧管理模块

#### 3.4.1 获取电视剧列表
```
GET /api/tv-shows?page=1&size=10&genre=剧情&year=2024&rating=8.0&actor=演员名&award=艾美奖

响应:
{
    "code": 200,
    "data": {
        "tvShows": [
            {
                "id": 1,
                "title": "电视剧标题",
                "originalTitle": "Original Title",
                "year": 2024,
                "genre": ["剧情", "悬疑"],
                "director": "导演姓名",
                "actors": ["演员1", "演员2"],
                "rating": 8.5,
                "poster": "海报URL",
                "summary": "电视剧简介",
                "awards": ["艾美奖最佳剧集"],
                "seasons": 3,
                "episodes": 30,
                "country": "美国",
                "language": "英语"
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

#### 3.4.2 获取电视剧详情
```
GET /api/tv-shows/{id}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "title": "电视剧标题",
        "originalTitle": "Original Title",
        "year": 2024,
        "genre": ["剧情", "悬疑"],
        "director": "导演姓名",
        "actors": ["演员1", "演员2"],
        "rating": 8.5,
        "poster": "海报URL",
        "summary": "电视剧简介",
        "awards": ["艾美奖最佳剧集"],
        "seasons": 3,
        "episodes": 30,
        "country": "美国",
        "language": "英语",
        "trailer": "预告片URL",
        "photos": ["剧照1", "剧照2"],
        "seasons": [
            {
                "id": 1,
                "number": 1,
                "title": "第一季",
                "episodes": 10,
                "year": 2024
            }
        ]
    }
}
```

### 3.5 综艺管理模块

#### 3.5.1 获取综艺列表
```
GET /api/variety-shows?page=1&size=10&genre=真人秀&year=2024&rating=8.0&host=主持人名&guest=嘉宾名

响应:
{
    "code": 200,
    "data": {
        "varietyShows": [
            {
                "id": 1,
                "title": "综艺标题",
                "originalTitle": "Original Title",
                "year": 2024,
                "genre": ["真人秀", "音乐"],
                "host": "主持人姓名",
                "guests": ["嘉宾1", "嘉宾2"],
                "rating": 8.5,
                "poster": "海报URL",
                "summary": "综艺简介",
                "awards": ["金鹰奖最佳综艺"],
                "episodes": 12,
                "country": "中国",
                "language": "中文"
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

### 3.6 演员管理模块

#### 3.6.1 获取演员列表
```
GET /api/actors?page=1&size=10&keyword=关键词&nationality=美国&gender=男

响应:
{
    "code": 200,
    "data": {
        "actors": [
            {
                "id": 1,
                "name": "演员姓名",
                "avatar": "头像URL",
                "birthDate": "1990-01-01",
                "nationality": "美国",
                "gender": "男",
                "moviesCount": 50,
                "tvShowsCount": 10,
                "awards": ["奥斯卡最佳男主角", "金球奖最佳男主角"]
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

#### 3.6.2 获取演员详情
```
GET /api/actors/{id}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "name": "演员姓名",
        "avatar": "头像URL",
        "birthDate": "1990-01-01",
        "nationality": "美国",
        "gender": "男",
        "biography": "演员简介",
        "movies": [
            {
                "id": 1,
                "title": "电影标题",
                "year": 2024,
                "role": "角色名称",
                "poster": "海报URL"
            }
        ],
        "tvShows": [
            {
                "id": 1,
                "title": "电视剧标题",
                "year": 2024,
                "role": "角色名称",
                "poster": "海报URL"
            }
        ],
        "awards": [
            {
                "id": 1,
                "name": "奥斯卡最佳男主角",
                "year": 2024,
                "movie": "获奖电影"
            }
        ]
    }
}
```

### 3.7 奖项管理模块

#### 3.7.1 获取奖项列表
```
GET /api/awards?page=1&size=10&year=2024&category=最佳影片

响应:
{
    "code": 200,
    "data": {
        "awards": [
            {
                "id": 1,
                "name": "奥斯卡",
                "category": "最佳影片",
                "year": 2024,
                "winner": {
                    "id": 1,
                    "title": "获奖电影",
                    "poster": "海报URL"
                }
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

#### 3.7.2 获取奖项详情
```
GET /api/awards/{id}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "name": "奥斯卡",
        "category": "最佳影片",
        "year": 2024,
        "description": "奖项描述",
        "winner": {
            "id": 1,
            "title": "获奖电影",
            "poster": "海报URL",
            "director": "导演姓名"
        },
        "nominees": [
            {
                "id": 2,
                "title": "提名电影1",
                "poster": "海报URL"
            },
            {
                "id": 3,
                "title": "提名电影2",
                "poster": "海报URL"
            }
        ]
    }
}
```

### 3.8 分类管理模块

#### 3.8.1 获取所有分类
```
GET /api/categories

响应:
{
    "code": 200,
    "data": [
        {
            "id": 1,
            "name": "电影",
            "type": "content",
            "subCategories": [
                {
                    "id": 11,
                    "name": "动作片",
                    "count": 100
                },
                {
                    "id": 12,
                    "name": "科幻片",
                    "count": 80
                }
            ]
        },
        {
            "id": 2,
            "name": "电视剧",
            "type": "content",
            "subCategories": [
                {
                    "id": 21,
                    "name": "古装剧",
                    "count": 50
                },
                {
                    "id": 22,
                    "name": "现代剧",
                    "count": 60
                }
            ]
        }
    ]
}
```

#### 3.8.2 获取分类下的内容
```
GET /api/categories/{id}/content?page=1&size=10&type=movie

响应:
{
    "code": 200,
    "data": {
        "content": [
            {
                "id": 1,
                "title": "内容标题",
                "type": "movie",
                "year": 2024,
                "rating": 8.5,
                "poster": "海报URL"
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

### 3.9 帖子管理模块

#### 3.9.1 获取帖子列表
```
GET /api/posts?page=1&size=10&category=电影评论&keyword=关键词

响应:
{
    "code": 200,
    "data": {
        "posts": [
            {
                "id": 1,
                "title": "帖子标题",
                "content": "帖子内容摘要",
                "author": {
                    "id": 1,
                    "username": "author1",
                    "nickname": "作者1",
                    "avatar": "avatar_url"
                },
                "category": "电影评论",
                "createTime": "2024-01-01T10:00:00",
                "views": 100,
                "likes": 20,
                "commentsCount": 5,
                "isLiked": false
            }
        ],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

#### 3.9.2 获取帖子详情
```
GET /api/posts/{id}

响应:
{
    "code": 200,
    "data": {
        "id": 1,
        "title": "帖子标题",
        "content": "完整帖子内容",
        "author": {
            "id": 1,
            "username": "author1",
            "nickname": "作者1",
            "avatar": "avatar_url"
        },
        "category": "电影评论",
        "createTime": "2024-01-01T10:00:00",
        "updateTime": "2024-01-01T11:00:00",
        "views": 100,
        "likes": 20,
        "commentsCount": 5,
        "isLiked": false,
        "tags": ["科幻", "动作"]
    }
}
```

#### 3.9.3 发布帖子
```
POST /api/posts
Authorization: Bearer {token}
Content-Type: application/json

请求参数:
{
    "title": "string",
    "content": "string",
    "category": "string",
    "tags": ["string"]
}

响应:
{
    "code": 200,
    "message": "发布成功",
    "data": {
        "id": 1,
        "title": "帖子标题",
        "content": "帖子内容",
        "createTime": "2024-01-01T10:00:00"
    }
}
```

#### 3.9.4 编辑帖子
```
PUT /api/posts/{id}
Authorization: Bearer {token}
Content-Type: application/json

请求参数:
{
    "title": "string",
    "content": "string",
    "category": "string",
    "tags": ["string"]
}

响应:
{
    "code": 200,
    "message": "更新成功",
    "data": {
        "id": 1,
        "title": "更新后的标题",
        "content": "更新后的内容",
        "updateTime": "2024-01-01T11:00:00"
    }
}
```

#### 3.9.5 删除帖子
```
DELETE /api/posts/{id}
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "删除成功"
}
```

#### 3.9.6 点赞帖子
```
POST /api/posts/{id}/like
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "点赞成功"
}
```

#### 3.9.7 取消点赞帖子
```
DELETE /api/posts/{id}/like
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "取消点赞成功"
}
```

### 3.10 评论管理模块

#### 3.10.1 获取评论列表
```
GET /api/posts/{id}/comments?page=1&size=10

响应:
{
    "code": 200,
    "data": {
        "comments": [
            {
                "id": 1,
                "content": "评论内容",
                "author": {
                    "id": 2,
                    "username": "commenter1",
                    "nickname": "评论者1",
                    "avatar": "avatar_url"
                },
                "createTime": "2024-01-01T10:00:00",
                "likes": 5,
                "replies": [
                    {
                        "id": 2,
                        "content": "回复内容",
                        "author": {
                            "id": 3,
                            "username": "replier1",
                            "nickname": "回复者1",
                            "avatar": "avatar_url"
                        },
                        "createTime": "2024-01-01T10:30:00"
                    }
                ]
            }
        ],
        "total": 20,
        "page": 1,
        "size": 10
    }
}
```

#### 3.10.2 发布评论
```
POST /api/comments
Authorization: Bearer {token}
Content-Type: application/json

请求参数:
{
    "content": "string",
    "postId": 1,
    "parentId": 0
}

响应:
{
    "code": 200,
    "message": "评论成功",
    "data": {
        "id": 1,
        "content": "评论内容",
        "createTime": "2024-01-01T10:00:00"
    }
}
```

#### 3.10.3 编辑评论
```
PUT /api/comments/{id}
Authorization: Bearer {token}
Content-Type: application/json

请求参数:
{
    "content": "string"
}

响应:
{
    "code": 200,
    "message": "更新成功",
    "data": {
        "id": 1,
        "content": "更新后的评论内容",
        "updateTime": "2024-01-01T11:00:00"
    }
}
```

#### 3.10.4 删除评论
```
DELETE /api/comments/{id}
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "删除成功"
}
```

### 3.11 文件上传模块

#### 3.11.1 上传头像
```
POST /api/upload/avatar
Authorization: Bearer {token}
Content-Type: multipart/form-data

请求参数:
file: 图片文件

响应:
{
    "code": 200,
    "message": "上传成功",
    "data": {
        "url": "https://example.com/avatar/123.jpg"
    }
}
```

#### 3.11.2 上传图片
```
POST /api/upload/image
Authorization: Bearer {token}
Content-Type: multipart/form-data

请求参数:
file: 图片文件

响应:
{
    "code": 200,
    "message": "上传成功",
    "data": {
        "url": "https://example.com/images/123.jpg"
    }
}
```

### 3.12 通知模块

#### 3.12.1 获取通知列表
```
GET /api/notifications?page=1&size=10
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "data": {
        "notifications": [
            {
                "id": 1,
                "type": "like",
                "title": "有人点赞了你的帖子",
                "content": "用户xxx点赞了你的帖子《xxx》",
                "isRead": false,
                "createTime": "2024-01-01T10:00:00"
            }
        ],
        "total": 20,
        "page": 1,
        "size": 10
    }
}
```

#### 3.12.2 标记通知为已读
```
PUT /api/notifications/{id}/read
Authorization: Bearer {token}

响应:
{
    "code": 200,
    "message": "标记成功"
}
```

### 3.13 搜索模块

#### 3.13.1 全局搜索
```
GET /api/search?keyword=关键词&type=posts&page=1&size=10

响应:
{
    "code": 200,
    "data": {
        "posts": [
            {
                "id": 1,
                "title": "搜索结果标题",
                "content": "搜索结果内容摘要",
                "author": {
                    "id": 1,
                    "username": "author1",
                    "nickname": "作者1",
                    "avatar": "avatar_url"
                },
                "createTime": "2024-01-01T10:00:00",
                "views": 100,
                "likes": 20
            }
        ],
        "users": [
            {
                "id": 2,
                "username": "user2",
                "nickname": "用户2",
                "avatar": "avatar_url",
                "postsCount": 10
            }
        ],
        "total": 50,
        "page": 1,
        "size": 10
    }
}
```

## 4. 响应格式规范

### 4.1 统一响应格式
```json
{
    "code": 200,
    "message": "操作成功",
    "data": {}
}
```

### 4.2 错误响应格式
```json
{
    "code": 400,
    "message": "请求参数错误",
    "data": null
}
```

### 4.3 分页响应格式
```json
{
    "code": 200,
    "data": {
        "list": [],
        "total": 100,
        "page": 1,
        "size": 10
    }
}
```

## 5. 状态码规范

### 5.1 HTTP状态码
- 200: 成功
- 400: 请求参数错误
- 401: 未授权
- 403: 禁止访问
- 404: 资源不存在
- 500: 服务器内部错误

### 5.2 业务状态码
- 200: 成功
- 400: 请求参数错误
- 401: 未授权
- 403: 禁止访问
- 404: 资源不存在
- 500: 服务器内部错误

## 6. 安全规范

### 6.1 认证方式
- 使用JWT Token进行身份认证
- Token过期时间：7天
- 支持Token刷新机制

### 6.2 权限控制
- 用户只能操作自己的资源
- 管理员拥有所有权限
- 支持角色权限管理

### 6.3 数据安全
- 密码使用BCrypt加密
- 防止SQL注入
- XSS攻击防护
- CSRF攻击防护

## 7. 性能优化

### 7.1 数据库优化
- 合理使用索引
- 分页查询优化
- 查询语句优化

### 7.2 缓存策略
- Redis缓存热点数据
- 缓存用户信息
- 缓存分类信息

### 7.3 接口优化
- 接口响应时间 < 1秒
- 支持并发访问
- 合理使用异步处理

## 8. 部署规范

### 8.1 环境配置
- 开发环境：localhost:8080
- 测试环境：test.example.com
- 生产环境：api.example.com

### 8.2 数据库配置
- 开发环境：本地MySQL
- 测试环境：测试数据库
- 生产环境：主从数据库

### 8.3 监控告警
- 接口响应时间监控
- 数据库性能监控
- 系统资源监控

## 9. 开发规范

### 9.1 代码规范
- 统一代码风格
- 合理注释
- 异常处理

### 9.2 接口规范
- RESTful风格
- 统一响应格式
- 统一错误处理

### 9.3 测试规范
- 单元测试覆盖率 > 80%
- 接口测试
- 性能测试

## 10. 版本管理

### 10.1 版本号规范
- 主版本号：重大功能更新
- 次版本号：功能更新
- 修订号：Bug修复

### 10.2 接口版本
- 当前版本：v1.0
- 支持版本兼容
- 废弃接口通知

## 11. 文档更新

### 11.1 更新记录
- 2024-01-01: 初始版本
- 2024-01-15: 增加电影管理模块
- 2024-02-01: 增加演员管理模块

### 11.2 维护说明
- 定期更新文档
- 及时同步接口变更
- 保持文档准确性

---

**文档版本**: v1.0  
**最后更新**: 2024-01-01  
**维护人员**: 开发团队
